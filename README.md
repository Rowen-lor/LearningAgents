# 双Agent系统PRD - 文献搜集与自动化测试

## 1. 产品概述

### 1.1 产品愿景
构建一个基于 MCP 协议的双 Agent 系统，包含文献搜集 Agent 和自动化测试 Agent，提高学术研究效率和产品测试自动化水平。

### 1.2 产品目标
- **文献搜集 Agent**：自动化文献检索、下载、格式转换和整理流程  
- **自动化测试 Agent**：实现前端产品的冒烟测试自动化  

---

## 2. Agent-1: 文献搜集 Agent

### 2.1 功能需求

#### 2.1.1 核心功能
- **文献检索**：支持多数据库检索（CNKI、arXiv、Google Scholar 等）
- **文献筛选**：基于访问权限和开放性筛选文献
- **文献下载**：自动下载 PDF 格式文献
- **格式转换**：PDF 转 TXT 格式转换
- **文件整理**：按主题分类整理文献
- **内容总结**：调用外部 AI 模型（如 Qwen）进行文献总结  

#### 2.1.2 技术功能
- **搜索引擎集成**：集成学术搜索 API
- **权限验证**：检查文献访问权限
- **下载管理**：批量下载和断点续传
- **OCR 识别**：处理扫描版 PDF
- **元数据提取**：提取标题、作者、摘要等信息  

### 2.2 用户场景
**主要用户**：大学生、研究人员  
**使用场景**：
- 研究生撰写论文时的文献调研
- 本科生课程作业的资料收集
- 教师备课的参考资料整理  

### 2.3 技术架构

#### 2.3.1 所需 MCP 组件
- `browser-use-mcp`: 网页浏览和交互
- `filesystem-mcp`: 文件系统操作
- `web-search-mcp`: 网络搜索功能
- `pdf-tools-mcp`: PDF 处理工具
- `api-client-mcp`: API 调用管理  

#### 2.3.2 外部集成
- CNKI 网页爬取（通过学校 IP 访问）
- arXiv API
- Google Scholar（通过爬虫）
- Qwen API（文献总结，输出 Markdown 格式）
- OCR 服务（如 Tesseract）

---

## 3. Agent-2: 自动化测试 Agent

### 3.1 功能需求

#### 3.1.1 核心功能
- **UI 元素识别**：识别各种前端元素（按钮、输入框、下拉菜单等）
- **交互操作**：模拟用户点击、输入、滚动等操作
- **不可见元素处理**：处理隐藏、异步加载的元素
- **测试执行**：执行预定义的测试用例集
- **结果记录**：生成测试报告和截图
- **异常处理**：识别和处理测试异常  

#### 3.1.2 高级功能
- **智能等待**：动态等待页面加载完成
- **断言验证**：验证页面状态和数据正确性
- **数据驱动**：支持多组测试数据
- **并发测试**：支持多浏览器并发执行  

### 3.2 用户场景
**主要用户**：内部开发团队、QA人员  
**使用场景**：
- 产品发版后的冒烟测试（前30步操作）
- Vue 应用的 UI 元素交互测试
- 快速验证核心功能是否正常  

### 3.3 技术架构

#### 3.3.1 所需 MCP 组件
- `browser-use-mcp`: 浏览器自动化核心
- `screenshot-mcp`: 截图功能
- `filesystem-mcp`: 测试报告存储
- `time-mcp`: 时间和等待操作  

#### 3.3.2 测试框架
- **浏览器引擎**：Playwright / Selenium
- **元素定位**：XPath、CSS 选择器、AI 视觉识别
- **测试数据**：JSON / YAML 配置文件
- **报告生成**：HTML / PDF 测试报告  

---

## 4. 系统集成架构

### 4.1 整体架构
![系统架构图](https://raw.githubusercontent.com/your-username/your-repo/main/architecture.png) 
graph LR
    subgraph Agent层
        A[文献搜集Agent] --> B(browser-use-mcp)
        A --> C(filesystem-mcp)
        A --> D(web-search-mcp)
        A --> E(pdf-tools-mcp)
        A --> F(api-client-mcp)

        G[自动化测试Agent] --> H(browser-use-mcp)
        G --> I(screenshot-mcp)
        G --> J(filesystem-mcp)
        G --> K(time-mcp)
    end

    subgraph MCP Server
        B --> L[browser-use]
        C --> M[filesystem]
        D --> N[web-search]
        E --> O[pdf-tools]
        I --> P[screenshot]
    end

### 4.2 数据流设计
1. **文献搜集流程**：关键词输入 → 搜索 → 筛选 → 下载 → 转换 → 整理 → 总结  
2. **测试执行流程**：测试配置 → 浏览器启动 → 用例执行 → 结果验证 → 报告生成  

---

## 5. 实施计划

### 5.1 开发阶段划分
- **Phase 1**：MCP 环境搭建和基础组件集成（1-2 周）
- **Phase 2**：文献搜集 Agent 开发（2-3 周）
- **Phase 3**：自动化测试 Agent 开发（2-3 周）
- **Phase 4**：系统集成和测试（1 周）
- **Phase 5**：部署和优化（1 周）

### 5.2 技术风险
- CNKI 反爬虫机制
- PDF 转换质量问题
- 前端元素变化导致测试失效
- 网络稳定性影响  

### 5.3 成功指标
- 文献搜集准确率 > 90%
- PDF 转 TXT 转换成功率 > 95%
- 自动化测试用例通过率 > 95%
- 系统稳定性 > 99%

---

## 6. 后续扩展
- 支持更多学术数据库
- 增加文献去重功能
- 支持移动端测试
- 集成更多 AI 模型
